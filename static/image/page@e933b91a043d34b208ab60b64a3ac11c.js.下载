function Swipe(t,e){"use strict";function n(){d=v.children,m=d.length,d.length<2&&(e.continuous=!1),l.transitions&&e.continuous&&d.length<3&&(v.appendChild(d[0].cloneNode(!0)),v.appendChild(v.children[1].cloneNode(!0)),d=v.children),f=new Array(d.length),g=t.getBoundingClientRect().width||t.offsetWidth,v.style.width=d.length*g+"px";for(var n=d.length;n--;){var i=d[n];i.style.width=g+"px",i.setAttribute("data-index",n),l.transitions&&(i.style.left=n*-g+"px",r(n,w>n?-g:w<n?g:0,0))}e.continuous&&l.transitions&&(r(o(w-1),-g,0),r(o(w+1),g,0)),l.transitions||(v.style.left=w*-g+"px"),t.style.visibility="visible",!P&&A&&(!function(t,e){var n=['<p class="'+T+'">'];if(t>1)for(var i=0;i<t;i++)n.push("<b"+(0==i?' class="'+S+'"':"")+"></b>");n.push("</p>"),e.append(n.join("")),x=e.find("."+T)}(m,$(t)),P=!0)}function i(){e.continuous?a(w+1):w<d.length-1&&a(w+1)}function o(t){return(d.length+t%d.length)%d.length}function a(t,n){if(w!=t){if(l.transitions){var i=Math.abs(w-t)/(w-t);if(e.continuous){var a=i;(i=-f[o(t)]/g)!==a&&(t=-i*d.length+t)}for(var c=Math.abs(w-t)-1;c--;)r(o((t>w?t:w)-c-1),g*i,0);t=o(t),r(w,g*i,n||b),r(t,0,n||b),e.continuous&&r(o(t-i),-g*i,0)}else t=o(t),function(t,n,i){if(!i)return void(v.style.left=n+"px");var o=+new Date,a=setInterval(function(){var s=+new Date-o;if(s>i)return v.style.left=n+"px",I&&h(),e.transitionEnd&&e.transitionEnd.call(event,w,d[w]),void clearInterval(a);v.style.left=(n-t)*(Math.floor(s/i*100)/100)+t+"px"},4)}(w*-g,t*-g,n||b);w=t,u(e.callback&&e.callback(w,d[w])),A&&s(w)}}function s(t){x.find("b").removeClass(S),2==m?$(x.find("b")[t%2]).addClass(S):$(x.find("b")[t]).addClass(S)}function r(t,e,n){c(t,e,n),f[t]=e}function c(t,e,n){var i=d[t],o=i&&i.style;o&&(o.webkitTransitionDuration=o.MozTransitionDuration=o.msTransitionDuration=o.OTransitionDuration=o.transitionDuration=n+"ms",o.webkitTransform="translate("+e+"px,0)translateZ(0)",o.msTransform=o.MozTransform=o.OTransform="translateX("+e+"px)")}function h(){y=setTimeout(i,I)}function p(){clearTimeout(y)}var u=function(t){setTimeout(t||function(){},0)},l={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(t){var e=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var n in e)if(void 0!==t.style[e[n]])return!0;return!1}(document.createElement("swipe"))};if(t){var d,f,g,m,v=t.children[0];e=e||{};var w=parseInt(e.startSlide,10)||0,b=e.speed||300;e.continuous=void 0===e.continuous||e.continuous;var y,k,x=null,T=e.navClassName||"mpw-nav-dots",S=e.navActiveClassName||"nav-active",A=void 0===e.dots||e.dots,P=!1,I=e.auto||0,L={},E={},C={handleEvent:function(t){switch(t.type){case"touchstart":this.start(t);break;case"touchmove":this.move(t);break;case"touchend":u(this.end(t));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":u(this.transitionEnd(t));break;case"resize":u(n.call())}e.stopPropagation&&t.stopPropagation()},start:function(t){var e=t.touches[0];L={x:e.pageX,y:e.pageY,time:+new Date},k=void 0,E={},v.addEventListener("touchmove",this,!1),v.addEventListener("touchend",this,!1)},move:function(t){if(!(t.touches.length>1||t.scale&&1!==t.scale)){e.disableScroll&&t.preventDefault();var n=t.touches[0];E={x:n.pageX-L.x,y:n.pageY-L.y},void 0===k&&(k=!!(k||Math.abs(E.x)<Math.abs(E.y))),k||(t.preventDefault(),p(),e.continuous?(c(o(w-1),E.x+f[o(w-1)],0),c(w,E.x+f[w],0),c(o(w+1),E.x+f[o(w+1)],0)):(E.x=E.x/(!w&&E.x>0||w==d.length-1&&E.x<0?Math.abs(E.x)/g+1:1),c(w-1,E.x+f[w-1],0),c(w,E.x+f[w],0),c(w+1,E.x+f[w+1],0)))}},end:function(t){var n=+new Date-L.time,i=Number(n)<250&&Math.abs(E.x)>20||Math.abs(E.x)>g/2,a=!w&&E.x>0||w==d.length-1&&E.x<0;e.continuous&&(a=!1);var c=E.x<0;k||(i&&!a?(c?(e.continuous?(r(o(w-1),-g,0),r(o(w+2),g,0)):r(w-1,-g,0),r(w,f[w]-g,b),r(o(w+1),f[o(w+1)]-g,b),w=o(w+1)):(e.continuous?(r(o(w+1),g,0),r(o(w-2),-g,0)):r(w+1,g,0),r(w,f[w]+g,b),r(o(w-1),f[o(w-1)]+g,b),w=o(w-1)),e.callback&&e.callback(w,d[w])):e.continuous?(r(o(w-1),-g,b),r(w,0,b),r(o(w+1),g,b)):(r(w-1,-g,b),r(w,0,b),r(w+1,g,b))),A&&s(w),v.removeEventListener("touchmove",C,!1),v.removeEventListener("touchend",C,!1)},transitionEnd:function(t){parseInt(t.target.getAttribute("data-index"),10)==w&&(I&&h(),e.transitionEnd&&e.transitionEnd.call(t,w,d[w]))}};return n(),I&&h(),l.addEventListener?(l.touch&&1!=m&&v.addEventListener("touchstart",C,!1),l.transitions&&1!=m&&(v.addEventListener("webkitTransitionEnd",C,!1),v.addEventListener("msTransitionEnd",C,!1),v.addEventListener("oTransitionEnd",C,!1),v.addEventListener("otransitionend",C,!1),v.addEventListener("transitionend",C,!1)),window.addEventListener("resize",C,!1)):window.onresize=function(){n()},{setup:function(){n()},slide:function(t,e){p(),a(t,e)},prev:function(){p(),e.continuous?a(w-1):w&&a(w-1)},next:function(){p(),i()},getPos:function(){return w},getNumSlides:function(){return m},kill:function(){p(),v.style.width="auto",v.style.left=0;for(var t=d.length;t--;){var e=d[t];e.style.width="100%",e.style.left=0,l.transitions&&c(t,0,0)}l.addEventListener?(v.removeEventListener("touchstart",C,!1),v.removeEventListener("webkitTransitionEnd",C,!1),v.removeEventListener("msTransitionEnd",C,!1),v.removeEventListener("oTransitionEnd",C,!1),v.removeEventListener("otransitionend",C,!1),v.removeEventListener("transitionend",C,!1),window.removeEventListener("resize",C,!1)):window.onresize=null}}}}!function(t,e){"function"==typeof define?define.amd?define(function(){return e()}):define.cmd&&define(function(t,n,i){i.exports=e()}):"object"==typeof module&&"object"==typeof module.exports?module.exports=e():t.QunarAPI=e()}("undefined"!=typeof window?window:this,function(){"use strict";function t(t){return"function"==typeof t}function e(t,e){for(var n in t)i.register(n,t[n],e)}function n(e,n,o){if(n){g[o]&&(n=g[o](n));var a=n.success,s=n.fail,c=n.complete,h=function(p){r.debug&&console.log(p);var u=Array.prototype.slice.call(arguments,0);p&&void 0!==p.ret?p.ret?(u[0]=p.data,t(a)&&a.apply(null,u),f.api[o]&&f.api[o].call(n,p.data||{})):t(s)&&s.apply(null,u):(t(a)&&a.apply(null,u),f.api[o]&&f.api[o].call(n,p||{})),t(c)&&c.apply(null,u),d.qunar&&p&&-1!=p.errcode&&f.bridge.method(o)&&i.invoke(e,h,n,o)};return i.invoke(e,h,n,o)}console.error("Parameters are not allowed to be empty!")}var i={},o=window,a=o.document,s=o.navigator.userAgent,r={},c=[],h=[],p={wechatApiUrl:"//res.wx.qq.com/open/js/jweixin-1.0.0.js"},u={},l={},d=/MicroMessenger/i.test(s)?{wechat:!0,version:""}:/Qunar/i.test(s)?{qunar:!0,version:""}:{h5:!0,version:""},f={api:{openWebView:function(){t(this.onViewBack)&&i.hy.onceReceiveData({success:this.onViewBack})}},bridge:{method:function(t){return m.share.wechat[t]||m.share.hy[t]?"invoke":""}}},g={checkJsApi:function(e){var n=u,i=e.success,o=e.jsApiList.slice(0);return e.jsApiList=o.map(function(t){return n[t]||t}),e.success=function(e){var a={};o.forEach(function(t){var i=n[t]||t;a[t]=e[i]||!1}),t(i)&&i.call(null,a)},e},log:function(t){if(function(t){return"[object String]"===Object.prototype.toString.call(t)}(t)){return{message:t}}return t}},m={common:{chooseImage:"chooseImage",previewImage:"previewImage",uploadImage:"uploadImage",uploadImage_v1:"uploadImage.v1",downloadImage:"downloadImage",getNetworkType:"network.getType",openLocation:"openLocation",getLocation:"geolocation.getCurrentPosition",closeWindow:"webview.back",hideOptionMenu:"hideOptionMenu",showOptionMenu:"showOptionMenu",hideMenuItems:"hideMenuItems",showMenuItems:"showMenuItems",hideAllNonBaseMenuItem:"hideAllNonBaseMenuItem",showAllNonBaseMenuItem:"showAllNonBaseMenuItem",hideLoadView:"webview.hideLoadView",onLoadingClose:"loadingview.close",scanQRCode:"scanQRCode",abTest:"abTest",checkJsApi:"checkJsApi"},share:{wechat:{onMenuShareTimeline:"onMenuShareTimeline",onMenuShareAppMessage:"onMenuShareAppMessage"},hy:{onMenuShareWeiboApp:"onMenuShareWeiboApp",onMenuShareSMS:"onMenuShareSMS",onMenuShareEmail:"onMenuShareEmail",onMenuShare:"onMenuShare",onMenuShareQunarIM:"onMenuShareQunarIM"}},hy:{openWebView:"webview.open",closeWebView:"webview.back",setWebViewAttr:"webview.attribute",getInitData:"webview.getInitData",enableBackGesture:"qunarnative.gesturesView",schemeForResult:"schemeForResult",onShow:"webview.onShow",onHide:"webview.onHide",onReceiveData:"webview.onReceiveData",onceReceiveData:"webview.onReceiveData",onCloseWebView:"webview.targetClosed",onceCloseWebView:"webview.targetClosed",onBeforeShow:"webview.onBeforeShow",onBeforeHide:"webview.onBeforeHide",onDestroy:"webview.onDestroy",navRefresh:"navigation.refresh",getNavDisplayStatus:"navigation.displayStatus",setNavDisplayStatus:"navigation.display",onNavClick:"navigation.click",setStatus:"qunarnative.status",shareTimeline:"shareTimeline",shareAppMessage:"sendAppMessage",shareWeiboApp:"shareWeiboApp",shareSMS:"shareSMS",shareEmail:"shareEmail",shareQunarIM:"shareQunarIM",shareImageToTimeline:"shareImageToTimeline",showShareItems:"doShare",getDeviceInfo:"native.getDeviceInfo",login:"login.start",syncLoginFromTouch:"syncLoginFromTouch",log:"debug.log",uelog:"hy.uelog",qaf:"qaf"},h5:{getLocation:function(t,e){navigator.geolocation?navigator.geolocation.getCurrentPosition(e.success,e.fail,{enableHighAccuracy:e.enableHighAccuracy||!0,timeout:e.timeout||5e3}):t({ret:!1,errcode:-1,errmsg:"Geolocation is not supported!"})},login:function(t,e){var n,i,o,a="";i="//user.qunar.com/mobile/login.jsp",n={ret:e.ret||encodeURIComponent(location.href),goback:e.goback||"",backUrl:e.backUrl||""};for(o in n)n.hasOwnProperty(o)&&""!==n[o]&&(a+=o+"="+n[o]);location.href=i+"?"+a},checkJsApi:function(t,e){var n,i={};(e.jsApiList||[]).forEach(function(t){n=l[t],i[t]=!!m.h5[n]}),t(i)},notSupport:function(e,n,i,o){t(e)&&e({ret:!1,errcode:-1,errmsg:'浏览器环境下不支持"'+o+'"接口调用'})}}};return i={version:"1.1.3",isReady:!1,bridge:null,sniff:d,ready:function(e){var n=this;d.qunar?a.addEventListener("WebViewJavascriptBridgeReady",function(o){n.isReady=!0,n.bridge=o.bridge,t(e)&&e.call(n),c.length>0&&(c.forEach(function(t){i.invoke(t.key,t.callback,t.param)}),c=[])}):d.h5?(n.isReady=!0,t(e)&&e.call(n)):d.wechat&&t(e)&&e.call(n)},config:function(t){n("config",r=t)},error:function(e){t(e)&&h.push(e)},invoke:function(e,n,o,a){if(t(n))if(i.isReady)if(d.qunar){var s="invoke";if(0===(a=a||e).indexOf("once")?s="once":0===a.indexOf("on")&&(s="on"),this.bridge[f.bridge.method(a)||s](e,n,o),"on"==s)return n}else d.wechat?this[e]&&this[e](o):d.h5&&m.h5[m.h5[a]?a:"notSupport"](n,o,e,a);else c.push({key:e,callback:n,param:o})},off:function(e,n){if(t(n)){var i=u[e];i&&(this.bridge.off(i,n),n=null)}},register:function(t,e,i){var o=this;i&&(o=this[i]?this[i]:this[i]={}),u[t]=e,l[e]=t,o[t]=function(i){return i||(i={}),n(e,i,t)}}},e(m.share.wechat),e(m.share.hy),e(m.common),e(m.hy,"hy"),function(){if(d.wechat){var e=a.getElementsByTagName("head")[0],n=a.createElement("script");n.setAttribute("src",p.wechatApiUrl),e.appendChild(n),n.onload=function(){for(var t in wx)i[t]=wx[t];i.onMenuShare=function(t){for(var e in m.share.wechat)i[e](t)},i.isReady=!0,c.forEach(function(t){i[t.key](t.param)}),c=[]}}else d.qunar&&(i.hy.onInitData=function(e){i.hy.getInitData({success:function(n){t(e.success)&&e.success(n)}})},window.addEventListener("load",function(){setTimeout(function(){i.bridge||function(t){h.length>0&&h.forEach(function(e){e(t)})}({ret:!1,errcode:-1,errmsg:"bridge注入失败"})},600)}))}(),i}),function(t){var e=t.hy.openWebView;t.hy.openWebView=function(t){0!=t.url.indexOf("http")&&0!=t.url.indexOf("https")&&(t.url=location.protocol+t.url),e(t)}}(QunarAPI),$.provide("ptouch.page.Dot"),ptouch.page.Dot=function(t){this.context=t,this.analytics=ptouch.Analytics.getInstance()},ptouch.page.Dot.prototype.handlePageReady=function(){this.context&&this.context.touchTimeObj&&this.context.touchTimeObj.windowStartTime&&(this.analytics.dispatch("fe",{a:"touch_firstscreen_time",value:{firstScreenTime:+new Date-this.context.touchTimeObj.windowStartTime,url:window.location.href}}),$(document).listen("touchstart",this.handleFirstTouch,this))},ptouch.page.Dot.prototype.handleFirstTouch=function(){$(document).unlisten("touchstart",this.handleFirstTouch,this),this.analytics.dispatch("fe",{a:"touch_firsttouch_time",value:{firstTouchTime:+new Date-this.context.touchTimeObj.windowStartTime,url:window.location.href}})},ptouch.page.Dot.prototype.dispatchException=function(t){this.analytics.dispatchException(t)},ptouch.page.Dot.prototype.dispatchTimeConsume=function(){var t=this.context.touchTimeObj;t&&t.windowStartTime&&t.cssLoadedTime&&t.scriptsStartTime&&t.scriptsLoadedTime&&this.analytics.dispatch("fe",{a:"touch_page_time",value:{cssLoadTime:t.cssLoadedTime-t.windowStartTime,htmlShowTime:t.scriptsStartTime-t.cssLoadedTime,jsLoadTime:t.scriptsLoadedTime-t.scriptsStartTime,jsRunTime:+new Date-t.scriptsLoadedTime,url:window.location.href}})},ptouch.page.Dot.prototype.dispatchClick=function(t){return this.analytics.dispatchClick(t)},ptouch.page.Dot.prototype.dispatchBeacon=function(t){return this.analytics.dispatchBeacon(t)},ptouch.page.Dot.prototype.getGlobalParams=function(){return{s:this.analytics.getPageId(),gid:$.env.gid,vid:$.env.vid,uniid:ptouch.Analytics.getUniId()}},$.provide("ptouch.page.Util"),ptouch.page.Util.isLegalURI=function(t){for(var e=["qunar.com","qunarzz.com","baidu.com","bdimg.com","bdstatic.com","res.wx.qq.com","google.cn","google.com","gstatic.com","gstatic.cn","googleapis.com","googleapis.cn","c-ctrip.com"],n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return!0;return!1},ptouch.page.Util.handleInject=function(t){var e=t.appendChild;t.appendChild=function(n){if(n){var i=n.tagName;if("IFRAME"!=i&&"SCRIPT"!=i||ptouch.page.Util.isLegalURI(n.src))return e.call(t,n),n}}},ptouch.page.Util.openWebView=function(t,e){"app"==e?QunarAPI.ready(function(){t.url?(0!=t.url.indexOf("http")&&0!=t.url.indexOf("https")&&0!=t.url.indexOf("//")&&(t.url=location.protocol+"//"+location.host+t.url),t.type||(t.type="navibar-none"),QunarAPI.hy.openWebView(t)):alert("网页链接错误")}):t.url&&(location.href=t.url)},ptouch.page.Util.navRefresh=function(t){QunarAPI.ready(function(){QunarAPI.hy.navRefresh(t)})},ptouch.page.Util.closeWebView=function(t,e){"app"==e?QunarAPI.ready(function(){QunarAPI.hy.closeWebView(t)}):t.url?window.location.href=t.url:history.back()},ptouch.page.Util.bindShare=function(t,e,n,i,o,a){if("weixin"==this.runOn)$.getScript("//q.qunarzz.com/piao_base/prd/scripts/release/wxshare-1.0.1.js",function(){t=t||"",e=e||"",n=n||"//simg1.qunarzz.com/piao/images/touch/app_logo100.png",i=i||window.location.href,$.util.WxShare(t,e,n,i)});else if("app"==this.runOn){var s={title:t,link:i,desc:e,imgUrl:n,success:o||function(){},fail:a||function(){}};QunarAPI.ready(function(){QunarAPI.onMenuShare(s)})}},ptouch.page.Util.triggerShare=function(t){"app"==t&&QunarAPI.ready(function(){QunarAPI.hy.showShareItems({})})},ptouch.page.Util.getDeviceInfo=function(t,e){QunarAPI.ready(function(){QunarAPI.hy.getDeviceInfo({success:function(n){"function"==typeof t&&t(n,e)}})})},$.provide("ptouch.page.View"),ptouch.page.View=function(t){this.element=null,this.runOn=t,this.userAgent=navigator.userAgent.toLowerCase()},ptouch.page.View.prototype.useAppHeader=!0,ptouch.page.View.prototype.init=function(t){if(!t instanceof $.zepto.Z&&(t=$(t)),this.setElement(t),this.header=t.find(".mp-header"),this.contentWrap=t.find(".mp-main"),this.headerLeft=this.header.role("left"),this.headerTitle=this.header.role("title"),this.headerRight=this.header.role("right"),"app"==this.runOn&&this.header.length&&(this.isIPhone()&&!this.useAppHeader&&(this.isIphoneX()?(this.header.css("padding-top","44px"),this.headerLeft.css("top","44px"),this.headerRight.css("top","44px")):(this.header.css("padding-top","20px"),this.headerLeft.css("top","20px"),this.headerRight.css("top","20px"))),this.useAppHeader&&this.header.addClass("mp-header-inapp")),"app"==this.runOn&&this.contentWrap.length){if(this.isIphoneX())var e="mp-content-iniphonex";else if(this.isIPhone())e="mp-content-iniphone";else e="mp-content-inaphone";this.contentWrap.addClass(e)}this.bindEvents()},ptouch.page.View.prototype.render=function(t){var e=$('<div class="mp-page" id="main-page"><div class="mp-header" style="display:none;"><a class="mp-header-left mpg-iconfont" mp-role="left">&#xf3cd;</a><h1 class="mp-header-title" mp-role="title"></h1><span class="mp-header-right" mp-role="right"></span></div><div class="mp-main" id="mp-main"></div></div>');e.appendTo(t),this.init(e)},ptouch.page.View.prototype.decorate=function(t){this.init(t)},ptouch.page.View.prototype.isIPhone=function(){return this.userAgent.indexOf("iphone")>-1},ptouch.page.View.prototype.isAndroid=function(){return this.userAgent.indexOf("android")>-1},ptouch.page.View.prototype.isIphoneX=function(){var t=this.isIPhone(),e=/(m\/10.3|m\/10.6)/.test(this.userAgent);return t&&e},ptouch.page.View.prototype.bindEvents=function(){$(document.body).listen("touchstart",function(){},this),"app"==this.runOn&&this.element.delegate("a[hybrid-link]","click",$.proxy(this.handleLinkClick,this)),this.useAppHeader&&this.bindNativeHeaderClick({success:$.proxy(this.handleHeaderClick,this)}),this.bindDomHeaderClick(),FastClick.attach(document.body)},ptouch.page.View.prototype.bindDomHeaderClick=function(){this.headerLeft.length>0&&this.headerLeft.listen("click",this.handleHeaderClick,this),this.headerTitle.length>0&&this.headerTitle.listen("click",this.handleHeaderClick,this),this.headerRight.length>0&&this.headerRight.listen("click",this.handleHeaderClick,this)},ptouch.page.View.prototype.setUseAppHeader=function(t){this.useAppHeader=t},ptouch.page.View.prototype.handleHeaderClick=function(t){var e="app"==this.runOn&&t.button&&!t.currentTarget,n=e?t.button:$(t.currentTarget),i=e?t.button:n.attr("mp-role"),o=e?"native":"dom",a=null;switch(i){case"left":a=new $.Event("headerleftclick",{element:n,srcType:o}),$(this).triggerHandler(a),a.isDefaultPrevented()||this.useAppHeader&&"app"==this.runOn||ptouch.page.Util.closeWebView({},this.runOn);break;case"title":a=new $.Event("headertitleclick",{element:n,srcType:o}),$(this).triggerHandler(a);break;case"right":a=new $.Event("headerrightclick",{element:n,srcType:o}),$(this).triggerHandler(a)}if(a&&a.isDefaultPrevented())return!1},ptouch.page.View.prototype.bindNativeHeaderClick=function(t){QunarAPI.ready(function(){QunarAPI.hy.onNavClick(t)})},ptouch.page.View.prototype.setElement=function(t){this.element=t},ptouch.page.View.prototype.enableScrollHeader=function(){this.scrollHeader=!0,this.header.css({position:"fixed",width:"100%",top:0,left:0}),this.setHeaderVisible(!1),this.createBackElement(),$(window).listen("scroll",this.handleHeaderScroll,this)},ptouch.page.View.prototype.handleBackElementClick=function(){ptouch.page.Util.closeWebView({},this.runOn)},ptouch.page.View.prototype.disableScrollHeader=function(){this.scrollHeader=!1,this.header.css("position","relative"),this.setHeaderVisible(!0),this.removeBackElement(),$(window).unlisten("scroll",this.handleHeaderScroll,this)},ptouch.page.View.prototype.createBackElement=function(){var t=$('<a class="mp-header-back mpg-iconfont"><span class="mp-headerback-bg"></span><span class="mp-headerback-icon">&#xe904;</span></a>');t.appendTo(this.element),this.isIPhone()&&"app"==this.runOn&&(this.isIphoneX()?t.css("top","44px"):t.css("top","20px")),this.backElement=t,this.backElement.listen("click",this.handleBackElementClick,this)},ptouch.page.View.prototype.removeBackElement=function(){this.backElement.unlisten("click",this.handleBackElementClick,this),this.backElement.remove()},ptouch.page.View.prototype.handleHeaderScroll=function(){var t=$(window).scrollTop();if(t<=180){this.backElement&&this.backElement.hide();var e=t/180;this.header.css({display:"block",opacity:e}),0==t&&(this.header.hide(),this.backElement&&this.backElement.show())}else this.header.css({display:"block",opacity:1})},ptouch.page.View.prototype.setContent=function(t){this.contentWrap.html(t)},ptouch.page.View.prototype.setHeader=function(t,e,n){t&&("object"==typeof t?this.headerTitle.html(t.html):"string"==typeof t&&this.headerTitle.html(t)),e&&("object"==typeof e?this.headerLeft.html(e.html):"string"==typeof e&&this.headerLeft.html(e)),n&&("object"==typeof n?this.headerRight.html(n.html):"string"==typeof n&&this.headerRight.html(n)),this.setHeaderVisible(!0)},ptouch.page.View.prototype.getElement=function(){return this.element},ptouch.page.View.prototype.getHeader=function(){return this.header},ptouch.page.View.prototype.getContent=function(){return this.contentWrap},ptouch.page.View.prototype.setHeaderVisible=function(t){t?this.header.show():this.header.hide()},ptouch.page.View.prototype.handleLinkClick=function(t){t.preventDefault();var e=t.currentTarget.href,n=t.currentTarget.title,i=$(t.currentTarget).attr("hy-header"),o=n&&"false"!=i?"navibar-normal":"navibar-none";return ptouch.page.Util.openWebView({url:e,animate:"moveFromRight",type:o,onViewBack:$.proxy(this.handleViewBack,this),navigation:{title:{style:"text",text:n}}},this.runOn),!1},ptouch.page.View.prototype.handleViewBack=function(t){$(this).triggerHandler("viewback",[t])},$.provide("ptouch.Page"),ptouch.Page=function(t){this.context=t||{},this.setRunOn(),ptouch.Page.runOn=this.runOn,this.view=new ptouch.page.View(this.runOn),this.dot=new ptouch.page.Dot(this.context)},ptouch.Page.prototype.setRunOn=function(){var t=navigator.userAgent.toLocaleLowerCase();if(t.indexOf("micromessenger")>-1)this.runOn="weixin";else if(this.context.scheme)this.context.scheme.indexOf("qunariphone")>-1||this.context.scheme.indexOf("qunaraphone")>-1?this.runOn="app":this.runOn="touch";else{var e=t.match(/(qunar[a-z]+)\/(\d+)/);e&&e.length?this.runOn="app":this.runOn="touch"}},ptouch.Page.prototype.init=function(t){try{"app"==this.runOn&&(this.handleScriptTemplate(),t instanceof $.zepto.Z&&(t=t.selector)),(t=$(t)).length?this.view.decorate(t):this.view.render(document.body),this.preventInject(),this.autoDispatchBeacon(),"app"==this.runOn?$.listen(window,"load",function(){setTimeout($.proxy(this.init_,this),0)},this):this.init_(),this.dot.dispatchTimeConsume()}catch(t){throw this.dot.dispatchException(t),t}},ptouch.Page.prototype.handleScriptTemplate=function(){var t=$('script[type="text/html"]');t.length&&t.each(function(e){var n=t.eq(e);$(n.html()).insertBefore(n),n.remove()})},ptouch.Page.prototype.autoDispatchBeacon=function(){this.dot.dispatchBeacon()},ptouch.Page.prototype.preventInject=function(){"https:"!=location.protocol&&(ptouch.page.Util.handleInject(document.head),ptouch.page.Util.handleInject(document.body))},ptouch.Page.prototype.bindShare=function(t,e,n,i,o,a){ptouch.page.Util.bindShare.apply(this,arguments)},ptouch.Page.prototype.triggerShare=function(){ptouch.page.Util.triggerShare(this.runOn)},ptouch.Page.prototype.setHeader=function(t,e,n,i,o){if(e||o||"weixin"==this.runOn||"touch"==this.runOn)this.view.setHeader(t,i,n),e&&(this.view.enableScrollHeader(),this.view.setUseAppHeader(!1));else if("app"==this.runOn){var a={};t&&("object"==typeof t?(t.text&&(document.title=t.text),a.title=t):"string"==typeof t&&(document.title=t,a.title={text:t,style:"text"})),i&&("object"==typeof i?a.left=i:"string"==typeof t&&(a.left={text:i,style:"text"})),n&&("object"==typeof n?a.right=n:"string"==typeof t&&(a.right={text:n,style:"text"})),QunarAPI.ready(function(){QunarAPI.hy.navRefresh(a)}),this.view.setUseAppHeader(!0)}},ptouch.Page.prototype.setContent=function(t){this.view.setContent(t),this.dot.handlePageReady()},ptouch.Page.prototype.getView=function(){return this.view},ptouch.Page.prototype.openWebView=function(t){ptouch.page.Util.openWebView(t,this.runOn)},ptouch.Page.prototype.closeWebView=function(t){ptouch.page.Util.closeWebView(t,this.runOn)},ptouch.Page.prototype.navRefresh=function(t){ptouch.page.Util.navRefresh(t)},ptouch.Page.prototype.getInitData=function(t){"app"==this.runOn?QunarAPI.ready(function(){QunarAPI.hy.getInitData({success:function(e){t(e)},fail:function(){t()}})}):t()},ptouch.Page.prototype.updateAndroidVersionInfo=function(t){$.os.android&&(t&&QunarAPI.ready(function(){QunarAPI.onLoadingClose({success:function(t,e){e({data:!0})}})}),ptouch.page.Util.getDeviceInfo(this.updateVersionCookie,{needReload:t}))},ptouch.Page.prototype.updateVersionCookie=function(t,e){var n=t.atomversion||{},i=n.sight,o=!1;if(e&&e.needReload&&(o=!0),n&&i){var a=$.cookie("QN278"),s=JSON.parse(decodeURIComponent(a||"{}"));if(a&&s.sight==i)QunarAPI.hideLoadView({});else{var r={sight:i};$.cookie("QN278",JSON.stringify(r),{expires:365,path:"/"}),o&&window.location.reload()}}else QunarAPI.hideLoadView({})},$.provide("ptouch.Purchase"),ptouch.Purchase=function(t){window.context.isShowUnPayOrderAlarm&&"true"==window.context.isShowUnPayOrderAlarm&&this.getOrderNum()},ptouch.Purchase.prototype={createDom:function(){this.entity=$('<a id="purchase-btn" class="mp-purchase" href="#"><div class="purchase-icon"></div></a>'),this.mainPageElem=$("#main-page")?$("#main-page"):$(document.body),this.mainPageElem.append(this.entity),this.entity.css({transform:"translate(-10px, -10px) translateZ(0px);"})},createNotPayNum:function(){0!=this.data.notPayOrderSize&&this.entity.append($('<div class="nopay">'+(this.data.notPayOrderSize>99?"...":this.data.notPayOrderSize)+"</div>")),this.entity.attr("href","/touch/order/list.htm")},getOrderNum:function(){$.ajax({url:"/touch/order/queryNotPayOrderSize.json",type:"get",dataType:"json",cache:!1,context:this,success:this.handleGetNumSuccess})},handleGetNumSuccess:function(t){t.ret&&t.data&&t.data.notPayOrderSize&&(this.data=t.data,this.createDom(),this.createNotPayNum())}},(window.jQuery||window.Zepto)&&function(t){t.fn.Swipe=function(e){return this.each(function(){t(this).data("Swipe",new Swipe(t(this)[0],e))})}}(window.jQuery||window.Zepto),$.Location=function(){this.location_=this.createLocation()},$.Location.prototype.createLocation=function(){var t;try{t=void 0===navigator.geolocation?google.gears.factory.create("beta.geolocation"):navigator.geolocation}catch(t){}return t},$.Location.prototype.isEnabled=function(){return!!this.location_},$.Location.prototype.aborted_=!1,$.Location.prototype.abort=function(){this.aborted_=!0},$.Location.prototype.isAborted=function(){return this.aborted_},$.Location.prototype.getCurrentPosition=function(t,e,n){this.aborted_=!1,this.location_&&this.location_.getCurrentPosition(t,e,n||{timeout:3e4})},void 0===window.QTMPL&&(window.QTMPL={}),window.QTMPL.atentrance=new window.Hogan.Template(function(t,e,n){return this.b(n=n||""),this.b('<div class="mpp-atentrance">'),this.b("\n"+n),this.b('    <h2 class="mp-modtitle">在景区门口？立即订票</h2>'),this.b("\n"+n),this.b('    <div class="mpp-atentrance-con">'),this.b("\n"+n),this.b('        <ul class="mp-flexbox">'),this.b("\n"+n),this.s(this.f("nearSightList",t,e,1),t,e,0,172,623,"{{ }}")&&(this.rs(t,e,function(t,e,i){i.b('            <li class="mp-flexbox-item atentrance-item" data-click="ts_around_sight" data-click-from-value="'),i.b(i.v(i.f("sightName",t,e,0))),i.b('" data-click-from-index="'),i.b(i.v(i.f("index",t,e,0))),i.b('" data-click-dist-city="'),i.b(i.v(i.f("dist_city",t,e,0))),i.b('">'),i.b("\n"+n),i.b('                <img class="mpp-atentrance-img" src="'),i.b(i.v(i.f("sightImgURL",t,e,0))),i.b('" alt="'),i.b(i.v(i.f("sightName",t,e,0))),i.b('">'),i.b("\n"+n),i.b('                <div class="mpp-atentrance-imgcover"></div>'),i.b("\n"+n),i.b('                <div class="mpp-atentrance-sightname">'),i.b(i.v(i.f("sightName",t,e,0))),i.b("</div>"),i.b("\n"+n),i.b("            </li>"),i.b("\n"+n)}),t.pop()),this.b("        </ul>"),this.b("\n"+n),this.b("    </div>"),this.b("\n"+n),this.s(this.f("nearSightList",t,e,1),t,e,0,689,1585,"{{ }}")&&(this.rs(t,e,function(t,e,i){i.b('    <div class="mp-atentrance-con" style="display:none;">'),i.b("\n"+n),i.b('        <div class="mpp-atentrance-ticket">'),i.b("\n"+n),i.b("            <ul>"),i.b("\n"+n),i.s(i.f("priceList",t,e,1),t,e,0,839,1425,"{{ }}")&&(i.rs(t,e,function(t,e,i){i.b('                <li class="mp-flexbox" data-click="ts_around_ticket" data-click-from-index="'),i.b(i.v(i.f("index",t,e,0))),i.b('" data-click-dist-city="'),i.b(i.v(i.f("dist_city",t,e,0))),i.b('">'),i.b("\n"+n),i.b('                    <div class="mp-flexbox-item">'),i.b("\n"+n),i.b('                        <h3 class="mpp-atentrance-name">'),i.b(i.v(i.f("ticketTypeName",t,e,0))),i.b("</h3>"),i.b("\n"+n),i.b('                        <p class="mpp-atentrance-time">'),i.b(i.v(i.f("bookDescription",t,e,0))),i.b("</p>"),i.b("\n"+n),i.b("                    </div>"),i.b("\n"+n),i.b('                    <div class="mpp-atentrance-price">&yen;<em>'),i.b(i.v(i.f("qunarPrice",t,e,0))),i.b("</em></div>"),i.b("\n"+n),i.b('                    <a href="'),i.b(i.v(i.f("bookingUrl",t,e,0))),i.b('" class="mp-atentrance-fulllink"></a>'),i.b("\n"+n),i.b("                </li>"),i.b("\n"+n)}),t.pop()),i.b("            </ul>"),i.b("\n"+n),i.b("        </div>"),i.b("\n"+n),i.b('        <div class="mp-modmore">'),i.b("\n"+n),i.b('            <a href="'),i.b(i.v(i.f("moreInfoUrl",t,e,0))),i.b('">查看所有产品</a>'),i.b("\n"+n),i.b("        </div>"),i.b("\n"+n),i.b("    </div>"),i.b("\n"+n)}),t.pop()),this.b("</div>"),this.fl()}),"undefined"!=typeof module&&(module.exports=window.QTMPL.atentrance),$.provide("ptouch.home.AtEntrance"),ptouch.home.AtEntrance=function(t){this.aroundSightUrl="/touch/getAroundSight.json",this.template=QTMPL.atentrance,this.runOn=t,this.init()},ptouch.home.AtEntrance.prototype={init:function(){this.aroundbtn=$("#around"),this.attachEvents(),this.initLocation()},initLocation:function(){var t=new $.Location;t.isEnabled()?t.getCurrentPosition($.proxy(this.handleGetLocationSuccess,this),$.proxy(this.handleGetLocationFailed,this),{timeout:5e3}):this.aroundbtn.html('<span class="mp-iconfont">&#xe608;</span>定位失败'),$("#around").unlisten("click",this.initLocation,this)},attachEvents:function(){$("#around").listen("click",this.initLocation,this)},handleGetLocationSuccess:function(t){this.lat=parseFloat(t.coords.latitude).toFixed(6),this.lng=parseFloat(t.coords.longitude).toFixed(6),$("#around").listen("click",this.handleAroundClick,this),this.initAroundSights(this.lat,this.lng),$.cookie("qunar_mp_geolocation",JSON.stringify({lat:this.lat,lng:this.lng,time:+new Date}),{path:"/"})},handleGetLocationFailed:function(){this.aroundbtn.html('<span class="mp-iconfont">&#xe608;</span>定位失败')},handleAroundClick:function(){var t="/touch/list.htm?keyword=&sort=dt";this.lat&&this.lng&&(t=t+"&lat="+this.lat+"&lng="+this.lng);var e=ptouch.Analytics.makeAnalyticsLink(t,{from_area:"ts_near_sight"});ptouch.page.Util.openWebView({type:"navibar-normal",url:e,navigation:{title:{style:"text",text:"去哪儿门票"}}},this.runOn)},initAroundSights:function(t,e){$.ajax({type:"get",timeout:2e4,dateType:"json",data:{lat:t,lng:e},url:this.aroundSightUrl,success:this.handleGetSightsSuccess,error:this.handleGetSightsError,context:this})},handleGetSightsSuccess:function(t){if(t.ret&&0!=t.data.length){for(var e=0;e<t.data.length;e++){t.data[e].index=e;var n="/touch/detail.htm?id="+t.data[e].sightId;if(t.data[e].moreInfoUrl=ptouch.Analytics.makeAnalyticsLink(n,{from_area:"ts_around_more"}),t.data[e].priceList&&0!=t.data[e].priceList.length)for(var i=0;i<t.data[e].priceList.length;i++)t.data[e].priceList[i].index=i,t.data[e].priceList[i].sightId=t.data[e].sightId,t.data[e].priceList[i].bookingUrl=ptouch.Analytics.makeAnalyticsLink(t.data[e].priceList[i].bookingUrl,{from_area:"ts_around_ticket",form_index:i})}t.data.dist_city=ptouch.Analytics.CAT.dist_city;var o=this.template.render({nearSightList:t.data});$(".mp-listitem-con").after(o),$(".atentrance-item").listen("click",this.handleChangeSight,this),$($(".atentrance-item")[0]).click()}},handleGetSightsError:function(){},handleChangeSight:function(t){var e=$(t.currentTarget),n=$(".mpp-atentrance-con ul li").index(e);$(".mp-atentrance-con").hide(),$(".mp-atentrance-con").eq(n).show()},handleClickNearBy:function(t){t.preventDefault(),this.handleChangeSight(t)}},ptouch.home.AppDownload=function(){""!=window.context.isDownApp&&"true"==window.context.isDownApp&&this.init()},ptouch.home.AppDownload.prototype={init:function(){try{this.storage=window.localStorage}catch(t){return}this.hasOpened()||this.isInApp()||this.createDom()},createDom:function(){var t="";t="weixin"==$.env.platform?"http://a.app.qq.com/o/simple.jsp?pkgname=com.mqunar.sight":$.os.ios?"https://itunes.apple.com/cn/app/qu-na-er-men-piao/id1123594791?mt=8":"http://sight.qunarzz.com/com.mqunar.sight/Qunar_Spider_C0010_60001138_release_20160718_1038.apk";var e=$('<div class="mpw-download"><span class="mpw-download-close">X</span><span class="mpw-download-logo"></span><p class="mpw-download-des">使用去哪儿门票客户端<br>享受专属优惠体验更流畅</p><a href="'+t+'" class="mpw-download-btn">立即下载</a></div>');this.mainPageElem=$("body"),this.mainPageElem.append(e),this.closeBtn=e.find(".mpw-download-close"),this.joinBtn=e.find(".mpw-download-btn"),this.elem=e,this.bindEvents()},isInApp:function(){var t=!1,e=navigator.userAgent.toLocaleLowerCase();return/(qunar[a-z]+)\/(\d+)/.test(e)&&(t=!0),t},bindEvents:function(){this.closeBtn.listen("click",this.handlerClose,this)},handlerClose:function(){this.elem.hide(),this.storeClose()},storeClose:function(){this.storage&&this.storage.setItem("closeDownload",+new Date)},hasOpened:function(){if(this.storage){var t=this.storage.getItem("closeDownload");if(t&&+new Date-parseInt(t)<2592e5)return!0}return!1}},$.provide("ptouch.home.Page"),ptouch.home.Page=function(){ptouch.Page.call(this,window.context)},$.inherits(ptouch.home.Page,ptouch.Page),$.extend(ptouch.home.Page.prototype,{init_:function(){new ptouch.home.AppDownload,new ptouch.Purchase,this.dot.handlePageReady(),this.render(),this.completeHref(),this.bindEvents()},bindEvents:function(){$("#category-container a").listen("click",this.handleCategoryClick,this),$("[mp-role=hotList] a").listen("click",this.handleHotSightClick,this),$("#weekend-trip a").listen("click",this.handleWeekendTripClick,this)},render:function(){$("#img-slider img, #category-container img").each(function(){var t=$(this),e=t.data("original-src");t.attr("src",e),t.css("opacity",1)}),$("#img-slider").Swipe({auto:3e3,continuous:!0,navActiveClassName:"ui-state-active"}),$("#category-container").Swipe({continuous:!1,navActiveClassName:"ui-state-active"});var t=$("#mp-main").find(".lazy-load img");t.lazyload({data_attribute:"original-src",load:function(){$(this).css({opacity:1})}}),t.each(function(){var t=$(this);t.data("original-src")||t.parent().addClass("image-ready")}),this.nearby=new ptouch.home.AtEntrance(this.runOn)},completeHref:function(){$('a[mp-role="analytics"]').each(function(){for(var t,e=$(this).data("params"),n=$(this).attr("href"),i=/([^&=]+)=([\w\W]*?)(&|$)/g,o={};null!=(t=i.exec(e));)o[t[1]]=t[2];$(this).attr("href",ptouch.Analytics.makeAnalyticsLink(n,o))})},handleCategoryClick:function(t){t.stopPropagation(),t.preventDefault();var e=$(t.currentTarget).attr("href"),n=ptouch.getParam(e,"keyword"),i=ptouch.getParam(e,"region");n&&(e=ptouch.setUrlParam(e,"keyword",encodeURIComponent(n))),i&&(e=ptouch.setUrlParam(e,"region",encodeURIComponent(i))),this.redirect(e,$(t.currentTarget).attr("title"))},handleWeekendTripClick:function(t){t.stopPropagation(),t.preventDefault();var e=$(t.currentTarget).attr("href"),n=ptouch.getParam(e,"skuName");e=ptouch.setUrlParam(e,"skuName",encodeURIComponent(n));var i=$(t.currentTarget).attr("title");this.redirect(e,i)},handleHotSightClick:function(t){t.stopPropagation(),t.preventDefault();var e=$(t.currentTarget),n=e.attr("href"),i=ptouch.getParam(e.data("params"),"from_value");this.redirect(n,i)},redirect:function(t,e,n){this.openWebView({type:n||"navibar-normal",url:t,navigation:{title:{style:"text",text:e}}})}});